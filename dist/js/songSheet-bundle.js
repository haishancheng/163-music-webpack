!function(e){var t={};function n(i){if(t[i])return t[i].exports;var o=t[i]={i:i,l:!1,exports:{}};return e[i].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,i){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(i,o,function(t){return e[t]}.bind(null,o));return i},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=5)}({0:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){window.eventHub={events:{},emit:function(e,t){for(var n in this.events)n===e&&this.events[n].map(function(e){e.call(void 0,t)})},on:function(e,t){void 0===this.events[e]&&(this.events[e]=[]),this.events[e].push(t)}}}},1:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){AV.init({appId:"IbKHNlRGRAFjYmmzC1gxhtdE-gzGzoHsz",appKey:"6SlQPqCcy8KwHVEhJpFeBFpG"})}},2:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};t.default=function(){({init:function(e,t){this.view=e,this.model=t,this.bindEventHub()},bindEventHub:function(){var e=this;window.eventHub.on("songSheetId",function(t){e.model.data.songSheet=t,e.model.findSongSheetSongs(e.model.data.songSheet.id).then(function(){e.view.render(e.model.data)})})}}).init({el:"section.musicList > .songList",template:'\n      <li>\n        <span class="order">{{order}}</span>\n        <h3>{{name}}</h3>\n        <p>\n          <svg class="SQsvg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1024 1024" fill="#FE672E">\n            <path d="M537.456788 684.682921l198.722994 0 18.48398 18.023492c5.709025 5.565762 13.102413 8.336876 20.490683 8.336876 7.636934 0 15.266705-2.962471 21.018709-8.859785 11.317767-11.607362 11.083429-30.191626-0.522909-41.509393l-17.499559-17.063631L778.150686 373.540532c0-16.210193-13.143345-29.352515-29.353538-29.352515L537.456788 344.188017c-16.210193 0-29.352515 13.143345-29.352515 29.352515l0 281.788851C508.104273 671.539576 521.246595 684.682921 537.456788 684.682921zM566.810327 402.893047l152.634306 0L719.444633 586.367755l-2.808976-2.739391c-11.611455-11.317767-30.193673-11.081383-41.509393 0.522909-11.317767 11.607362-11.083429 30.191626 0.522909 41.509393l0.323365 0.315178L566.810327 625.975844 566.810327 402.893047z"></path>\n            <path d="M220.442668 625.976868c-16.210193 0-29.352515 13.143345-29.352515 29.353538s13.143345 29.352515 29.352515 29.352515l211.342406 0c16.210193 0 29.352515-13.143345 29.352515-29.352515L461.137589 514.433422c0-16.210193-13.143345-29.353538-29.352515-29.353538L249.796206 485.079884l0-82.187861 181.989891 0c16.210193 0 29.352515-13.143345 29.352515-29.352515 0-16.210193-13.143345-29.352515-29.352515-29.352515L220.442668 344.186993c-16.210193 0-29.352515 13.143345-29.352515 29.352515l0 140.893914c0 16.210193 13.143345 29.352515 29.352515 29.352515l181.989891 0 0 82.189907L220.442668 625.975844z"></path>\n            <path d="M933.722904 236.364289 88.354304 236.364289c-13.508665 0-24.461111 10.952446-24.461111 24.461111L63.893192 768.045537c0 13.508665 10.952446 24.461111 24.461111 24.461111l845.367577 0c13.508665 0 24.461111-10.952446 24.461111-24.461111L958.182992 260.824377C958.182992 247.315712 947.230546 236.364289 933.722904 236.364289zM909.261793 743.584426 112.815415 743.584426 112.815415 285.285488l796.446377 0L909.261793 743.584426z"></path>\n          </svg>{{singer}}\n        </p>\n        <a class="playButton" href="./song.html?id={{id}}">\n          <svg class="icon icon-play" aria-hidden="true">\n              <use xlink:href="#icon-play"></use>\n          </svg>\n        </a>\n      </li>\n    ',render:function(e){var t=this;e.songSheetSongs.map(function(e,n){var i=2===(n+1).toString().length?n+1:"0"+(n+1),o=$(t.template.replace("{{name}}",e.name).replace("{{singer}}",e.singer).replace("{{id}}",e.id).replace("{{order}}",i));$(t.el).append(o)})}},{data:{songSheet:{},songSheetSongs:[]},findSongSheetSongs:function(e){var t=this,n=AV.Object.createWithoutData("SongSheet",e),o=new AV.Query("Song");return o.equalTo("dependent",n),o.find().then(function(e){t.data.songSheetSongs=e.map(function(e){return i({id:e.id},e.attributes)})})}})}},3:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){({init:function(e,t){this.view=e,this.model=t,this.bindEvents(),this.bindEventHub()},bindEvents:function(){var e=this;$(this.view.el).on("click",function(){$(e.view.el).hasClass("show")?$(e.view.el).removeClass("show"):$(e.view.el).addClass("show")})},bindEventHub:function(){var e=this;window.eventHub.on("songSheetId",function(t){e.model.data=t,e.view.render(e.model.data)})}}).init({el:"section.brief",render:function(e){$(this.el).text(e.brief)}},{data:{}})}},30:function(e,t){},4:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){({init:function(e,t){this.view=e,this.model=t,this.bindEventHub()},bindEventHub:function(){var e=this;window.eventHub.on("songSheetId",function(t){e.model.data=t,e.view.render(e.model.data)})}}).init({el:"header",template:'\n      <div class="cover">\n        <img src="__cover__">\n      </div>\n      <p class="songSheetName">__name__</p>\n    ',render:function(e){$(this.el).css("background-image","url("+e.cover+")");var t=$(this.template.replace("__cover__",e.cover).replace("__name__",e.name));$(this.el).append(t)}},{data:{}})}},5:function(e,t,n){"use strict";var i=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e};n(30);var o=l(n(1)),r=l(n(0)),a=l(n(4)),s=l(n(3)),u=l(n(2));function l(e){return e&&e.__esModule?e:{default:e}}var c={data:{},fetch:function(e){var t=this;return new AV.Query("SongSheet").get(e).then(function(e){i(t.data,i({id:e.id},e.attributes))})}},d={init:function(e,t){var n=this;this.view=e,this.model=t,(0,a.default)(),(0,s.default)(),(0,u.default)();var i=this.getSongId();this.model.fetch(i).then(function(){window.eventHub.emit("songSheetId",JSON.parse(JSON.stringify(n.model.data)))})},getSongId:function(){var e=window.location.search;0===e.indexOf("?")&&(e=e.substring(1));for(var t=e.split("&").filter(function(e){return e}),n="",i=0;i<t.length;i++){var o=t[i].split("="),r=o[0],a=o[1];if("id"===r){n=a;break}}return n}};(0,o.default)(),(0,r.default)(),d.init({},c)}});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vLy4vc3JjL2pzL2NvbW1vbi9ldmVudC1odWIuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2pzL2NvbW1vbi9hdi5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvanMvc29uZ1NoZWV0L211c2ljTGlzdC5qcyIsIndlYnBhY2s6Ly8vLi9zcmMvanMvc29uZ1NoZWV0L2JyaWVmLmpzIiwid2VicGFjazovLy8uL3NyYy9qcy9zb25nU2hlZXQvdGl0bGUuanMiLCJ3ZWJwYWNrOi8vLy4vc3JjL2pzL3NvbmdTaGVldC9zb25nU2hlZXRFbnRyeS5qcyJdLCJuYW1lcyI6WyJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiZXhwb3J0cyIsIm1vZHVsZSIsImkiLCJsIiwibW9kdWxlcyIsImNhbGwiLCJtIiwiYyIsImQiLCJuYW1lIiwiZ2V0dGVyIiwibyIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwiZW51bWVyYWJsZSIsImdldCIsInIiLCJTeW1ib2wiLCJ0b1N0cmluZ1RhZyIsInZhbHVlIiwidCIsIm1vZGUiLCJfX2VzTW9kdWxlIiwibnMiLCJjcmVhdGUiLCJrZXkiLCJiaW5kIiwibiIsIm9iamVjdCIsInByb3BlcnR5IiwicHJvdG90eXBlIiwiaGFzT3duUHJvcGVydHkiLCJwIiwicyIsIndpbmRvdyIsImV2ZW50SHViIiwiZXZlbnRzIiwiZW1pdCIsImV2ZW50TmFtZSIsImRhdGEiLCJ0aGlzIiwibWFwIiwiZm4iLCJ1bmRlZmluZWQiLCJvbiIsInB1c2giLCJBViIsImluaXQiLCJhcHBJZCIsImFwcEtleSIsInZpZXciLCJtb2RlbCIsImJpbmRFdmVudEh1YiIsIl90aGlzMyIsInNvbmdTaGVldCIsImZpbmRTb25nU2hlZXRTb25ncyIsImlkIiwidGhlbiIsInJlbmRlciIsImVsIiwidGVtcGxhdGUiLCJfdGhpcyIsInNvbmdTaGVldFNvbmdzIiwic29uZ1NoZWV0U29uZyIsImluZGV4Iiwib3JkZXIiLCJ0b1N0cmluZyIsImxlbmd0aCIsIiRsaSIsIiQiLCJyZXBsYWNlIiwic2luZ2VyIiwiYXBwZW5kIiwic29uZ1NoZWV0SWQiLCJfdGhpczIiLCJjcmVhdGVXaXRob3V0RGF0YSIsInF1ZXJ5IiwiUXVlcnkiLCJlcXVhbFRvIiwiZmluZCIsInNvbmdzIiwic29uZyIsIl9leHRlbmRzIiwiYXR0cmlidXRlcyIsImJpbmRFdmVudHMiLCJoYXNDbGFzcyIsInJlbW92ZUNsYXNzIiwiYWRkQ2xhc3MiLCJ0ZXh0IiwiYnJpZWYiLCJjc3MiLCJjb3ZlciIsIiR0ZW1wbGF0ZSIsImZldGNoIiwiY29udHJvbGxlciIsIl90aXRsZTIiLCJkZWZhdWx0IiwiX2JyaWVmMiIsIl9tdXNpY0xpc3QyIiwiZ2V0U29uZ0lkIiwiSlNPTiIsInBhcnNlIiwic3RyaW5naWZ5Iiwic2VhcmNoIiwibG9jYXRpb24iLCJpbmRleE9mIiwic3Vic3RyaW5nIiwiYXJyYXkiLCJzcGxpdCIsImZpbHRlciIsInYiLCJrdiIsImsiLCJfYXYyIiwiX2V2ZW50SHViMiJdLCJtYXBwaW5ncyI6ImFBQ0EsSUFBQUEsS0FHQSxTQUFBQyxFQUFBQyxHQUdBLEdBQUFGLEVBQUFFLEdBQ0EsT0FBQUYsRUFBQUUsR0FBQUMsUUFHQSxJQUFBQyxFQUFBSixFQUFBRSxJQUNBRyxFQUFBSCxFQUNBSSxHQUFBLEVBQ0FILFlBVUEsT0FOQUksRUFBQUwsR0FBQU0sS0FBQUosRUFBQUQsUUFBQUMsSUFBQUQsUUFBQUYsR0FHQUcsRUFBQUUsR0FBQSxFQUdBRixFQUFBRCxRQUtBRixFQUFBUSxFQUFBRixFQUdBTixFQUFBUyxFQUFBVixFQUdBQyxFQUFBVSxFQUFBLFNBQUFSLEVBQUFTLEVBQUFDLEdBQ0FaLEVBQUFhLEVBQUFYLEVBQUFTLElBQ0FHLE9BQUFDLGVBQUFiLEVBQUFTLEdBQTBDSyxZQUFBLEVBQUFDLElBQUFMLEtBSzFDWixFQUFBa0IsRUFBQSxTQUFBaEIsR0FDQSxvQkFBQWlCLGVBQUFD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LEdBQ1gsR0FBUyxPQUFOQyxFQUFXLENBQ1p4RCxFQUFLc0QsRUFDTCxPQUlKLE9BQU90RCxLQUlYLEVBQUF5RCxFQUFBakIsWUFDQSxFQUFBa0IsRUFBQWxCLFdBQ0FGLEVBQVcvQyxRQUFXSSIsImZpbGUiOiJqcy9zb25nU2hlZXQtYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDUpO1xuIiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oKXtcclxuICAvLyDkuovku7bkuK3lv4MsIOWPkeW4g+iuoumYheaooeW8j1xyXG4gIHdpbmRvdy5ldmVudEh1YiA9IHtcclxuICAgIGV2ZW50czoge1xyXG4gICAgICAvLyBldmVudDE6IFtmbjEsIGZuMiwgLi4uXVxyXG4gICAgICAvLyBldmVudDI6IFtmbkEsIGZuQiwgLi4uXVxyXG4gICAgICAvLyAuLi5cclxuICAgIH0sXHJcbiAgICBlbWl0KGV2ZW50TmFtZSwgZGF0YSl7Ly/lj5HluIMo6Kem5Y+R5LqL5Lu277yM6ZyA6KaB5Y+R6YCB5pWw5o2u6ICF6ZyA6KaB6LCD55So5Y+R5biDKe+8jOaJvuWIsOmCo+S4quahtu+8jOaKiumHjOmdoueahOWHveaVsOWFqOmDvWNhbGzkuIDpgY3vvIxjYWxs55qE5pe25YCZ5bim5LiqZGF0YVxyXG4gICAgICBmb3IobGV0IGtleSBpbiB0aGlzLmV2ZW50cyl7XHJcbiAgICAgICAgaWYoa2V5ID09PSBldmVudE5hbWUpe1xyXG4gICAgICAgICAgdGhpcy5ldmVudHNba2V5XS5tYXAoKGZuKSA9PiB7XHJcbiAgICAgICAgICAgIGZuLmNhbGwodW5kZWZpbmVkLCBkYXRhKVxyXG4gICAgICAgICAgfSlcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0sXHJcbiAgICBvbihldmVudE5hbWUsIGZuKXsvL+iuoumYhSjmjqXmlLbkuovku7bvvIzmjqXmlLbmlbDmja7ogIXpnIDopoHosIPnlKjorqLpmIUpLOaKiuS9oOeahOWHveaVsOaUvuWIsOS4gOS4quahtumHjOmdolxyXG4gICAgICBpZih0aGlzLmV2ZW50c1tldmVudE5hbWVdID09PSB1bmRlZmluZWQpe1xyXG4gICAgICAgIHRoaXMuZXZlbnRzW2V2ZW50TmFtZV0gPSBbXVxyXG4gICAgICB9XHJcbiAgICAgIHRoaXMuZXZlbnRzW2V2ZW50TmFtZV0ucHVzaChmbilcclxuICAgIH0sXHJcbiAgfVxyXG59IiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oKXtcclxuICBsZXQgQVBQX0lEID0gJ0liS0hObFJHUkFGalltbXpDMWd4aHRkRS1nekd6b0hzeic7XHJcbiAgbGV0IEFQUF9LRVkgPSAnNlNsUVBxQ2N5OEt3SFZFaEpwRmVCRnBHJztcclxuICBBVi5pbml0KHtcclxuICAgIGFwcElkOiBBUFBfSUQsXHJcbiAgICBhcHBLZXk6IEFQUF9LRVlcclxuICB9KTtcclxufSIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uKCl7XHJcbiAgbGV0IHZpZXcgPSB7XHJcbiAgICBlbDogJ3NlY3Rpb24ubXVzaWNMaXN0ID4gLnNvbmdMaXN0JyxcclxuICAgIHRlbXBsYXRlOiBgXHJcbiAgICAgIDxsaT5cclxuICAgICAgICA8c3BhbiBjbGFzcz1cIm9yZGVyXCI+e3tvcmRlcn19PC9zcGFuPlxyXG4gICAgICAgIDxoMz57e25hbWV9fTwvaDM+XHJcbiAgICAgICAgPHA+XHJcbiAgICAgICAgICA8c3ZnIGNsYXNzPVwiU1FzdmdcIiB4bWxucz1cImh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnXCIgdmlld0JveD1cIjAgMCAxMDI0IDEwMjRcIiBmaWxsPVwiI0ZFNjcyRVwiPlxyXG4gICAgICAgICAgICA8cGF0aCBkPVwiTTUzNy40NTY3ODggNjg0LjY4MjkyMWwxOTguNzIyOTk0IDAgMTguNDgzOTggMTguMDIzNDkyYzUuNzA5MDI1IDUuNTY1NzYyIDEzLjEwMjQxMyA4LjMzNjg3NiAyMC40OTA2ODMgOC4zMzY4NzYgNy42MzY5MzQgMCAxNS4yNjY3MDUtMi45NjI0NzEgMjEuMDE4NzA5LTguODU5Nzg1IDExLjMxNzc2Ny0xMS42MDczNjIgMTEuMDgzNDI5LTMwLjE5MTYyNi0wLjUyMjkwOS00MS41MDkzOTNsLTE3LjQ5OTU1OS0xNy4wNjM2MzFMNzc4LjE1MDY4NiAzNzMuNTQwNTMyYzAtMTYuMjEwMTkzLTEzLjE0MzM0NS0yOS4zNTI1MTUtMjkuMzUzNTM4LTI5LjM1MjUxNUw1MzcuNDU2Nzg4IDM0NC4xODgwMTdjLTE2LjIxMDE5MyAwLTI5LjM1MjUxNSAxMy4xNDMzNDUtMjkuMzUyNTE1IDI5LjM1MjUxNWwwIDI4MS43ODg4NTFDNTA4LjEwNDI3MyA2NzEuNTM5NTc2IDUyMS4yNDY1OTUgNjg0LjY4MjkyMSA1MzcuNDU2Nzg4IDY4NC42ODI5MjF6TTU2Ni44MTAzMjcgNDAyLjg5MzA0N2wxNTIuNjM0MzA2IDBMNzE5LjQ0NDYzMyA1ODYuMzY3NzU1bC0yLjgwODk3Ni0yLjczOTM5MWMtMTEuNjExNDU1LTExLjMxNzc2Ny0zMC4xOTM2NzMtMTEuMDgxMzgzLTQxLjUwOTM5MyAwLjUyMjkwOS0xMS4zMTc3NjcgMTEuNjA3MzYyLTExLjA4MzQyOSAzMC4xOTE2MjYgMC41MjI5MDkgNDEuNTA5MzkzbDAuMzIzMzY1IDAuMzE1MTc4TDU2Ni44MTAzMjcgNjI1Ljk3NTg0NCA1NjYuODEwMzI3IDQwMi44OTMwNDd6XCI+PC9wYXRoPlxyXG4gICAgICAgICAgICA8cGF0aCBkPVwiTTIyMC40NDI2NjggNjI1Ljk3Njg2OGMtMTYuMjEwMTkzIDAtMjkuMzUyNTE1IDEzLjE0MzM0NS0yOS4zNTI1MTUgMjkuMzUzNTM4czEzLjE0MzM0NSAyOS4zNTI1MTUgMjkuMzUyNTE1IDI5LjM1MjUxNWwyMTEuMzQyNDA2IDBjMTYuMjEwMTkzIDAgMjkuMzUyNTE1LTEzLjE0MzM0NSAyOS4zNTI1MTUtMjkuMzUyNTE1TDQ2MS4xMzc1ODkgNTE0LjQzMzQyMmMwLTE2LjIxMDE5My0xMy4xNDMzNDUtMjkuMzUzNTM4LTI5LjM1MjUxNS0yOS4zNTM1MzhMMjQ5Ljc5NjIwNiA0ODUuMDc5ODg0bDAtODIuMTg3ODYxIDE4MS45ODk4OTEgMGMxNi4yMTAxOTMgMCAyOS4zNTI1MTUtMTMuMTQzMzQ1IDI5LjM1MjUxNS0yOS4zNTI1MTUgMC0xNi4yMTAxOTMtMTMuMTQzMzQ1LTI5LjM1MjUxNS0yOS4zNTI1MTUtMjkuMzUyNTE1TDIyMC40NDI2NjggMzQ0LjE4Njk5M2MtMTYuMjEwMTkzIDAtMjkuMzUyNTE1IDEzLjE0MzM0NS0yOS4zNTI1MTUgMjkuMzUyNTE1bDAgMTQwLjg5MzkxNGMwIDE2LjIxMDE5MyAxMy4xNDMzNDUgMjkuMzUyNTE1IDI5LjM1MjUxNSAyOS4zNTI1MTVsMTgxLjk4OTg5MSAwIDAgODIuMTg5OTA3TDIyMC40NDI2NjggNjI1Ljk3NTg0NHpcIj48L3BhdGg+XHJcbiAgICAgICAgICAgIDxwYXRoIGQ9XCJNOTMzLjcyMjkwNCAyMzYuMzY0Mjg5IDg4LjM1NDMwNCAyMzYuMzY0Mjg5Yy0xMy41MDg2NjUgMC0yNC40NjExMTEgMTAuOTUyNDQ2LTI0LjQ2MTExMSAyNC40NjExMTFMNjMuODkzMTkyIDc2OC4wNDU1MzdjMCAxMy41MDg2NjUgMTAuOTUyNDQ2IDI0LjQ2MTExMSAyNC40NjExMTEgMjQuNDYxMTExbDg0NS4zNjc1NzcgMGMxMy41MDg2NjUgMCAyNC40NjExMTEtMTAuOTUyNDQ2IDI0LjQ2MTExMS0yNC40NjExMTFMOTU4LjE4Mjk5MiAyNjAuODI0Mzc3Qzk1OC4xODI5OTIgMjQ3LjMxNTcxMiA5NDcuMjMwNTQ2IDIzNi4zNjQyODkgOTMzLjcyMjkwNCAyMzYuMzY0Mjg5ek05MDkuMjYxNzkzIDc0My41ODQ0MjYgMTEyLjgxNTQxNSA3NDMuNTg0NDI2IDExMi44MTU0MTUgMjg1LjI4NTQ4OGw3OTYuNDQ2Mzc3IDBMOTA5LjI2MTc5MyA3NDMuNTg0NDI2elwiPjwvcGF0aD5cclxuICAgICAgICAgIDwvc3ZnPnt7c2luZ2VyfX1cclxuICAgICAgICA8L3A+XHJcbiAgICAgICAgPGEgY2xhc3M9XCJwbGF5QnV0dG9uXCIgaHJlZj1cIi4vc29uZy5odG1sP2lkPXt7aWR9fVwiPlxyXG4gICAgICAgICAgPHN2ZyBjbGFzcz1cImljb24gaWNvbi1wbGF5XCIgYXJpYS1oaWRkZW49XCJ0cnVlXCI+XHJcbiAgICAgICAgICAgICAgPHVzZSB4bGluazpocmVmPVwiI2ljb24tcGxheVwiPjwvdXNlPlxyXG4gICAgICAgICAgPC9zdmc+XHJcbiAgICAgICAgPC9hPlxyXG4gICAgICA8L2xpPlxyXG4gICAgYCxcclxuICAgIHJlbmRlcihkYXRhKXtcclxuICAgICAgbGV0IHtzb25nU2hlZXRTb25nc30gPSBkYXRhXHJcbiAgICAgIHNvbmdTaGVldFNvbmdzLm1hcCgoc29uZ1NoZWV0U29uZywgaW5kZXgpID0+IHtcclxuICAgICAgICBsZXQgb3JkZXIgPSAoaW5kZXggKyAxKS50b1N0cmluZygpLmxlbmd0aCA9PT0gMiA/IChpbmRleCArIDEpIDogKCcwJyArIChpbmRleCArIDEpKVxyXG4gICAgICAgIGxldCAkbGkgPSAkKFxyXG4gICAgICAgICAgdGhpcy50ZW1wbGF0ZS5yZXBsYWNlKCd7e25hbWV9fScsIHNvbmdTaGVldFNvbmcubmFtZSlcclxuICAgICAgICAgICAgLnJlcGxhY2UoJ3t7c2luZ2VyfX0nLCBzb25nU2hlZXRTb25nLnNpbmdlcilcclxuICAgICAgICAgICAgLnJlcGxhY2UoJ3t7aWR9fScsIHNvbmdTaGVldFNvbmcuaWQpXHJcbiAgICAgICAgICAgIC5yZXBsYWNlKCd7e29yZGVyfX0nLCBvcmRlcilcclxuICAgICAgICApXHJcbiAgICAgICAgJCh0aGlzLmVsKS5hcHBlbmQoJGxpKVxyXG4gICAgICB9KVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgbGV0IG1vZGVsID0ge1xyXG4gICAgZGF0YTp7XHJcbiAgICAgIHNvbmdTaGVldDp7fSxcclxuICAgICAgc29uZ1NoZWV0U29uZ3M6IFtdXHJcbiAgICB9LFxyXG4gICAgZmluZFNvbmdTaGVldFNvbmdzKHNvbmdTaGVldElkKXtcclxuICAgICAgdmFyIHNvbmdTaGVldCA9IEFWLk9iamVjdC5jcmVhdGVXaXRob3V0RGF0YSgnU29uZ1NoZWV0Jywgc29uZ1NoZWV0SWQpO1xyXG4gICAgICB2YXIgcXVlcnkgPSBuZXcgQVYuUXVlcnkoJ1NvbmcnKTtcclxuICAgICAgcXVlcnkuZXF1YWxUbygnZGVwZW5kZW50Jywgc29uZ1NoZWV0KTtcclxuICAgICAgcmV0dXJuIHF1ZXJ5LmZpbmQoKS50aGVuKChzb25ncykgPT4ge1xyXG4gICAgICAgIHRoaXMuZGF0YS5zb25nU2hlZXRTb25ncyA9IHNvbmdzLm1hcCgoc29uZyk9PntcclxuICAgICAgICAgIHJldHVybiBPYmplY3QuYXNzaWduKHtpZDogc29uZy5pZH0sIHNvbmcuYXR0cmlidXRlcylcclxuICAgICAgICB9KVxyXG4gICAgICB9KVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgbGV0IGNvbnRyb2xsZXIgPSB7XHJcbiAgICBpbml0KHZpZXcsIG1vZGVsKXtcclxuICAgICAgdGhpcy52aWV3ID0gdmlld1xyXG4gICAgICB0aGlzLm1vZGVsID0gbW9kZWxcclxuICAgICAgdGhpcy5iaW5kRXZlbnRIdWIoKVxyXG4gICAgfSxcclxuICAgIGJpbmRFdmVudEh1Yigpe1xyXG4gICAgICB3aW5kb3cuZXZlbnRIdWIub24oJ3NvbmdTaGVldElkJywoZGF0YSk9PntcclxuICAgICAgICB0aGlzLm1vZGVsLmRhdGEuc29uZ1NoZWV0ID0gZGF0YVxyXG4gICAgICAgIHRoaXMubW9kZWwuZmluZFNvbmdTaGVldFNvbmdzKHRoaXMubW9kZWwuZGF0YS5zb25nU2hlZXQuaWQpLnRoZW4oKCk9PntcclxuICAgICAgICAgIHRoaXMudmlldy5yZW5kZXIodGhpcy5tb2RlbC5kYXRhKVxyXG4gICAgICAgIH0pXHJcbiAgICAgIH0pXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBjb250cm9sbGVyLmluaXQodmlldywgbW9kZWwpXHJcbn0iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbigpe1xyXG4gIGxldCB2aWV3ID0ge1xyXG4gICAgZWw6ICdzZWN0aW9uLmJyaWVmJyxcclxuICAgIHJlbmRlcihkYXRhKXtcclxuICAgICAgJCh0aGlzLmVsKS50ZXh0KGRhdGEuYnJpZWYpXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBsZXQgbW9kZWwgPSB7XHJcbiAgICBkYXRhOntcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGxldCBjb250cm9sbGVyID0ge1xyXG4gICAgaW5pdCh2aWV3LCBtb2RlbCl7XHJcbiAgICAgIHRoaXMudmlldyA9IHZpZXdcclxuICAgICAgdGhpcy5tb2RlbCA9IG1vZGVsXHJcbiAgICAgIHRoaXMuYmluZEV2ZW50cygpXHJcbiAgICAgIHRoaXMuYmluZEV2ZW50SHViKClcclxuICAgIH0sXHJcbiAgICBiaW5kRXZlbnRzKCl7XHJcbiAgICAgICQodGhpcy52aWV3LmVsKS5vbignY2xpY2snLCAoKT0+e1xyXG4gICAgICAgIGlmKCQodGhpcy52aWV3LmVsKS5oYXNDbGFzcygnc2hvdycpKXtcclxuICAgICAgICAgICQodGhpcy52aWV3LmVsKS5yZW1vdmVDbGFzcygnc2hvdycpXHJcbiAgICAgICAgfWVsc2V7XHJcbiAgICAgICAgICAkKHRoaXMudmlldy5lbCkuYWRkQ2xhc3MoJ3Nob3cnKVxyXG4gICAgICAgIH1cclxuICAgICAgfSlcclxuICAgIH0sXHJcbiAgICBiaW5kRXZlbnRIdWIoKXtcclxuICAgICAgd2luZG93LmV2ZW50SHViLm9uKCdzb25nU2hlZXRJZCcsKGRhdGEpPT57XHJcbiAgICAgICAgdGhpcy5tb2RlbC5kYXRhID0gZGF0YVxyXG4gICAgICAgIHRoaXMudmlldy5yZW5kZXIodGhpcy5tb2RlbC5kYXRhKVxyXG4gICAgICB9KVxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgY29udHJvbGxlci5pbml0KHZpZXcsIG1vZGVsKVxyXG59IiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24oKXtcclxuICBsZXQgdmlldyA9IHtcclxuICAgIGVsOiAnaGVhZGVyJyxcclxuICAgIHRlbXBsYXRlOmBcclxuICAgICAgPGRpdiBjbGFzcz1cImNvdmVyXCI+XHJcbiAgICAgICAgPGltZyBzcmM9XCJfX2NvdmVyX19cIj5cclxuICAgICAgPC9kaXY+XHJcbiAgICAgIDxwIGNsYXNzPVwic29uZ1NoZWV0TmFtZVwiPl9fbmFtZV9fPC9wPlxyXG4gICAgYCxcclxuICAgIHJlbmRlcihkYXRhKXtcclxuICAgICAgJCh0aGlzLmVsKS5jc3MoJ2JhY2tncm91bmQtaW1hZ2UnLCBgdXJsKCR7ZGF0YS5jb3Zlcn0pYClcclxuICAgICAgbGV0ICR0ZW1wbGF0ZSA9ICQodGhpcy50ZW1wbGF0ZS5yZXBsYWNlKCdfX2NvdmVyX18nLCBkYXRhLmNvdmVyKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC5yZXBsYWNlKCdfX25hbWVfXycsIGRhdGEubmFtZSkpXHJcbiAgICAgICQodGhpcy5lbCkuYXBwZW5kKCR0ZW1wbGF0ZSlcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGxldCBtb2RlbCA9IHtcclxuICAgIGRhdGE6e1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgbGV0IGNvbnRyb2xsZXIgPSB7XHJcbiAgICBpbml0KHZpZXcsIG1vZGVsKXtcclxuICAgICAgdGhpcy52aWV3ID0gdmlld1xyXG4gICAgICB0aGlzLm1vZGVsID0gbW9kZWxcclxuICAgICAgdGhpcy5iaW5kRXZlbnRIdWIoKVxyXG4gICAgfSxcclxuICAgIGJpbmRFdmVudEh1Yigpe1xyXG4gICAgICB3aW5kb3cuZXZlbnRIdWIub24oJ3NvbmdTaGVldElkJywoZGF0YSk9PntcclxuICAgICAgICB0aGlzLm1vZGVsLmRhdGEgPSBkYXRhXHJcbiAgICAgICAgdGhpcy52aWV3LnJlbmRlcih0aGlzLm1vZGVsLmRhdGEpXHJcbiAgICAgIH0pXHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBjb250cm9sbGVyLmluaXQodmlldywgbW9kZWwpXHJcbn0iLCJpbXBvcnQgJy4uLy4uL2Nzcy9zb25nU2hlZXQuY3NzJ1xyXG5pbXBvcnQgYXYgZnJvbSAnLi4vY29tbW9uL2F2J1xyXG5pbXBvcnQgZXZlbnRIdWIgZnJvbSAnLi4vY29tbW9uL2V2ZW50LWh1YidcclxuXHJcbmltcG9ydCB0aXRsZSBmcm9tICcuL3RpdGxlJ1xyXG5pbXBvcnQgYnJpZWYgZnJvbSAnLi9icmllZidcclxuaW1wb3J0IG11c2ljTGlzdCBmcm9tICcuL211c2ljTGlzdCdcclxuXHJcbntcclxuICBsZXQgdmlldyA9IHt9XHJcblxyXG4gIGxldCBtb2RlbCA9IHtcclxuICAgIGRhdGE6e1xyXG4gICAgfSxcclxuICAgIGZldGNoKGlkKXtcclxuICAgICAgdmFyIHF1ZXJ5ID0gbmV3IEFWLlF1ZXJ5KCdTb25nU2hlZXQnKVxyXG4gICAgICByZXR1cm4gcXVlcnkuZ2V0KGlkKS50aGVuKChzb25nU2hlZXQpID0+IHtcclxuICAgICAgICBPYmplY3QuYXNzaWduKHRoaXMuZGF0YSwgT2JqZWN0LmFzc2lnbih7aWQ6IHNvbmdTaGVldC5pZH0sIHNvbmdTaGVldC5hdHRyaWJ1dGVzKSlcclxuICAgICAgfSlcclxuICAgIH1cclxuICB9XHJcbiAgbGV0IGNvbnRyb2xsZXIgPSB7XHJcbiAgICBpbml0KHZpZXcsIG1vZGVsKXtcclxuICAgICAgdGhpcy52aWV3ID0gdmlld1xyXG4gICAgICB0aGlzLm1vZGVsID0gbW9kZWxcclxuICAgICAgdGl0bGUoKVxyXG4gICAgICBicmllZigpXHJcbiAgICAgIG11c2ljTGlzdCgpXHJcblxyXG4gICAgICBsZXQgaWQgPSB0aGlzLmdldFNvbmdJZCgpXHJcbiAgICAgIHRoaXMubW9kZWwuZmV0Y2goaWQpLnRoZW4oKCk9PntcclxuICAgICAgICB3aW5kb3cuZXZlbnRIdWIuZW1pdCgnc29uZ1NoZWV0SWQnLCBKU09OLnBhcnNlKEpTT04uc3RyaW5naWZ5KHRoaXMubW9kZWwuZGF0YSkpKVxyXG4gICAgICB9KVxyXG4gICAgICBcclxuICAgIH0sXHJcbiAgICBnZXRTb25nSWQoKXtcclxuICAgICAgbGV0IHNlYXJjaCA9IHdpbmRvdy5sb2NhdGlvbi5zZWFyY2hcclxuICAgICAgaWYoc2VhcmNoLmluZGV4T2YoJz8nKSA9PT0gMCl7XHJcbiAgICAgICAgc2VhcmNoID0gc2VhcmNoLnN1YnN0cmluZygxKVxyXG4gICAgICB9XHJcbiAgICAgIGxldCBhcnJheSA9IHNlYXJjaC5zcGxpdCgnJicpLmZpbHRlcigodikgPT4ge1xyXG4gICAgICAgIHJldHVybiB2XHJcbiAgICAgIH0pXHJcbiAgICAgIGxldCBpZCA9ICcnXHJcbiAgICAgIGZvcihsZXQgaT0wOyBpPGFycmF5Lmxlbmd0aDsgaSsrKXtcclxuICAgICAgICBsZXQga3YgPSBhcnJheVtpXS5zcGxpdCgnPScpXHJcbiAgICAgICAgbGV0IGsgPSBrdlswXVxyXG4gICAgICAgIGxldCB2ID0ga3ZbMV1cclxuICAgICAgICBpZihrID09PSAnaWQnKXtcclxuICAgICAgICAgIGlkID0gdlxyXG4gICAgICAgICAgYnJlYWtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHJldHVybiBpZFxyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgYXYoKVxyXG4gIGV2ZW50SHViKClcclxuICBjb250cm9sbGVyLmluaXQodmlldywgbW9kZWwpXHJcbn0iXSwic291cmNlUm9vdCI6IiJ9